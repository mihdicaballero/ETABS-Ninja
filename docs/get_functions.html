<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>etabsninja.get_functions API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>etabsninja.get_functions</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from etabsninja.general_functions import *
from colorama import Fore, Style

def get_story_data(SapModel):
    &#34;&#34;&#34;
    returns:
    story_data (list). The is a nested list with each element consists of
    [story_nm,story_ele,story_hgt,is_master_story,similar_to,splice_above,
     splice_height]
    &#34;&#34;&#34;
    #Get the data using API
    story_in=SapModel.Story.GetStories()
    #Separate the data to lists
    nos_stories=story_in[0];
    story_nms=story_in[1];
    story_eles=story_in[2];
    story_hgts=story_in[3];
    is_master_story=story_in[4];
    similar_to_story=story_in[5];
    splice_above=story_in[6];
    splice_height=story_in[7];
    # Create a dictionary to hold the data
    story_data_dict = {
        &#39;Name&#39;: story_nms[::-1],
        &#39;Elevation (in)&#39;: [round(ele, 3) for ele in story_eles[::-1]],
        &#39;Story height (in)&#39;: [round(hgt, 3) for hgt in story_hgts[::-1]],
        &#39;Master Story&#39;: is_master_story[::-1],
        &#39;Similar to&#39;: similar_to_story[::-1],
        &#39;Splice above&#39;: splice_above[::-1],
        &#39;Splice height&#39;: splice_height[::-1]
    }
    
    # Create a DataFrame from the dictionary
    story_data = pd.DataFrame(story_data_dict)
    return story_data

def get_all_frames(SapModel):
    &#34;&#34;&#34;
    Returns:
    frames_data (DataFrame): A DataFrame with data of all frames.
    &#34;&#34;&#34;
    # Get the frame objects using the API
    frame_objs = SapModel.FrameObj.GetAllFrames()
    
    # Create an empty list to hold frame data
    frames = []
    
    # Populate the frames list with data from frame_objs
    for i in range(frame_objs[0]):
        frameNm = frame_objs[1][i]
        prop = frame_objs[2][i]
        story = frame_objs[3][i]
        pt1 = frame_objs[4][i]
        pt2 = frame_objs[5][i]
        x1 = frame_objs[6][i]
        y1 = frame_objs[7][i]
        z1 = frame_objs[8][i]
        x2 = frame_objs[9][i]
        y2 = frame_objs[10][i]
        z2 = frame_objs[11][i]
        rot = frame_objs[12][i]
        offX1 = frame_objs[13][i]
        offY1 = frame_objs[14][i]
        offZ1 = frame_objs[15][i]
        offX2 = frame_objs[16][i]
        offY2 = frame_objs[17][i]
        offZ2 = frame_objs[18][i]
        cardPt = frame_objs[19][i]
        
        frames.append([
            frameNm, prop, story,
            pt1, pt2,
            x1, y1, z1,
            x2, y2, z2,
            rot,
            offX1, offY1, offZ1,
            offX2, offY2, offZ2,
            cardPt
        ])
    
    # Create a DataFrame from the list
    columns = [
        &#39;Frame Name&#39;, &#39;Property&#39;, &#39;Story&#39;,
        &#39;Point 1&#39;, &#39;Point 2&#39;,
        &#39;X1&#39;, &#39;Y1&#39;, &#39;Z1&#39;,
        &#39;X2&#39;, &#39;Y2&#39;, &#39;Z2&#39;,
        &#39;Rotation&#39;,
        &#39;Offset X1&#39;, &#39;Offset Y1&#39;, &#39;Offset Z1&#39;,
        &#39;Offset X2&#39;, &#39;Offset Y2&#39;, &#39;Offset Z2&#39;,
        &#39;Cardinal Point&#39;
    ]
    frames_data = pd.DataFrame(frames, columns=columns)
    
    return frames_data

def get_all_materials(SapModel):
    &#34;&#34;&#34;
    Gets the materials in the current model. Will return in units mm, N &amp; MPa.
    
    If the property type is either &#39;Concrete&#39; or &#39;Steel&#39;, the function will
    be expanded so that the strength of materials are included.
    
    Returns
    materials : Type dict
    &#34;&#34;&#34;
    # Set the Etabs units, all strength of materials will be returned in MPa
    # SapModel.SetPresentUnits(9);
    # switch to k-in units
    kip_in_F = 3
    ret = SapModel.SetPresentUnits(kip_in_F)

    # Etabs material type enumerators
    mat_types={1:&#39;Steel&#39;,2:&#39;Concrete&#39;,3:&#39;NoDesign&#39;,4:&#39;Aluminum&#39;,5:&#39;ColdFormed&#39;,
               6:&#39;Rebar&#39;,7:&#39;Tendon&#39;,8:&#39;Masonry&#39;}; 
    mat_name_list=SapModel.PropMaterial.GetNameList();
    materials={};
    for i in range(mat_name_list[0]):
        mat_name=mat_name_list[1][i];
        mat_props=SapModel.PropMaterial.GetMaterial(mat_name);
        mat_type=mat_types[mat_props[0]];
        if(mat_type==&#39;Concrete&#39;):
            mat_conc_prop=SapModel.PropMaterial.GetOConcrete_1(mat_name);
            conc_fc=mat_conc_prop[0];
            materials[mat_name]={&#39;mat_name&#39;:mat_name,&#39;mat_type&#39;:mat_type,
                                 &#39;fc&#39;:conc_fc};
        elif(mat_type==&#39;Steel&#39;):
            mat_steel_prop=SapModel.PropMaterial.GetOSteel_1(mat_name);
            steel_fy=mat_steel_prop[0];
            steel_fu=mat_steel_prop[1];
            materials[mat_name]={&#39;mat_name&#39;:mat_name,&#39;mat_type&#39;:mat_type,
                                 &#39;fy&#39;:steel_fy,&#39;fu&#39;:steel_fu};
        else:
            materials[mat_name]={&#39;mat_name&#39;:mat_name,&#39;mat_type&#39;:mat_type};
    return materials;

def get_all_points(SapModel,inc_restraint=True):
    &#34;&#34;&#34;
    This will return all the points of the model.
    
    Parameters:
    SapModel : SapModel.Pointer
    inc_restraint : boolean (set True for restraints to be included
                             to points list)
    units : str. Default to &#39;mm&#39;
    
    Returns:
    points : list (Points in current Etabs model). Elements in the points
    list if inc_restraint==False [pt_nm,x,y,z]. If inc_restraint==True the
    point element = [pt_nm,x,y,z,(FUx,FUy,FUz,FRx,FRy,FRz)]
    &#34;&#34;&#34;
    [numberPts,ptNames,ptX,ptY,ptZ,ptCsys]=SapModel.PointObj.GetAllPoints();
    #initiate a temporary list to contain the restrained points data
    ptsRestraint=[];
    if(inc_restraint==True):
        for i in range(numberPts):
            ptRestraintSA=SapModel.PointObj.GetRestraint(ptNames[i]);
            ptRestraint=ptRestraintSA[0];
            ptsRestraint.append(ptRestraint);
    #Initiate the points list
    points=[]
    for i in range(numberPts):
        if(inc_restraint==True):
            points.append([ptNames[i],ptX[i],ptY[i],ptZ[i],ptsRestraint[i]]);
        else:
            points.append([ptNames[i],ptX[i],ptY[i],ptZ[i]]);
    # Define column names
    if inc_restraint:
        columns = [&#39;Point Name&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;, &#39;Restraint&#39;]
    else:
        columns = [&#39;Point Name&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;]
    
    # Create a DataFrame from the list
    points_data = pd.DataFrame(points, columns=columns)
    
    return points_data

def get_StoryDriftsForStories(SapModel, LoadCaseList=[&#34;Dead&#34;], predefined_max_drift = 0.0025):
    &#34;&#34;&#34;
    returns:
    df (DataFrame). A data frame with all the drifts of the stories for a single case. 
    &#34;&#34;&#34;
    #Get the data using API
    SapModel.DatabaseTables.SetLoadCasesSelectedForDisplay(LoadCaseList)
    TableName = &#34;Story Drifts&#34;
    TableFields = SapModel.DatabaseTables.GetAllFieldsInTable(TableName)[2]
    JointDrifts = SapModel.DatabaseTables.GetTableForDisplayArray(TableName, TableFields, &#34;All&#34;)[4]
    TableFieldsIncluded = SapModel.DatabaseTables.GetTableForDisplayArray(TableName, TableFields, &#34;All&#34;)[2]
    # Determine the number of columns
    NumColumns = len(TableFieldsIncluded)

    # Reshape the JointDrifts list into a 2D array with the appropriate dimensions
    joint_drifts_array = [JointDrifts[i:i+NumColumns] for i in range(0, len(JointDrifts), NumColumns)]

    # Create the DataFrame using the reshaped array and the column names
    df = pd.DataFrame(joint_drifts_array, columns=TableFieldsIncluded)

    # Convert &#39;Drift&#39; column to float
    df[[&#39;Drift&#39;]] = df[[&#39;Drift&#39;]].astype(float)

    # Group the DataFrame by &#39;Story&#39; and calculate the minimum and maximum values of &#39;Drift&#39;
    df = df.groupby([&#39;Story&#39;,&#39;Direction&#39;])[[&#39;Drift&#39;]].agg([&#39;max&#39;])

    # Flatten the column names by joining them with an underscore
    df.columns = [&#39;_&#39;.join(col).strip() for col in df.columns.values]

    # Reset the index to make &#39;Story&#39; a regular column
    df.reset_index(inplace=True)

    # Pivot the DataFrame to create separate columns for &#39;DriftX&#39; and &#39;DriftY&#39; values
    df = df.pivot(index=&#39;Story&#39;, columns=&#39;Direction&#39;, values=&#39;Drift_max&#39;).reset_index()

    # Rename the columns
    df.columns = [&#39;Story&#39;, &#39;DriftX_max&#39;, &#39;DriftY_max&#39;]

    # Sort the DataFrame by &#39;Story&#39; column in alphabetical order
    df = df.sort_values(&#39;Story&#39;, ascending=True)

    # Create a scatter plot with lines connecting the points
    plt.plot(df[&#39;DriftX_max&#39;], df[&#39;Story&#39;], label=&#39;DriftX_max&#39;)
    plt.plot(df[&#39;DriftY_max&#39;], df[&#39;Story&#39;], label=&#39;DriftY_max&#39;)

    # Add labels and title
    plt.xlabel(&#39;Drift&#39;)
    plt.title(&#39;Drift vs. Story&#39;)
    # Add a legend
    plt.legend()

    # Get the maximum value of Drifts
    max_drift_x = df[&#39;DriftX_max&#39;].max()
    max_drift_y = df[&#39;DriftY_max&#39;].max()

    bold_terminal(&#34;Story drift for stories check&#34;)
    FU(&#34;Drift X&#34;, max_drift_x, predefined_max_drift)
    FU(&#34;Drift Y&#34;, max_drift_y, predefined_max_drift)

    return df

def get_StoryDriftsForJoints(SapModel, LoadCaseList=[&#34;Dead&#34;], GroupName=&#34;All&#34;, predefined_max_drift = 0.0025):
    &#34;&#34;&#34;
    returns:
    df (DataFrame). A data frame with all the drifts of selected column Joints for all the stories. 
    test
    &#34;&#34;&#34;
    JointsGroupName = GroupName # Put &#34;All&#34; for all nodes of the model
    TableName = &#34;Joint Drifts&#34;
    SapModel.DatabaseTables.SetLoadCasesSelectedForDisplay(LoadCaseList)
    TableFields = SapModel.DatabaseTables.GetAllFieldsInTable(TableName)[2]
    JointDrifts = SapModel.DatabaseTables.GetTableForDisplayArray(TableName, TableFields, JointsGroupName)[4]
    TableFieldsIncluded = SapModel.DatabaseTables.GetTableForDisplayArray(TableName, TableFields, &#34;All&#34;)[2]

    # Determine the number of columns
    NumColumns = len(TableFieldsIncluded)

    # Reshape the JointDrifts list into a 2D array with the appropriate dimensions
    joint_drifts_array = [JointDrifts[i:i+NumColumns] for i in range(0, len(JointDrifts), NumColumns)]

    # Create the DataFrame using the reshaped array and the column names
    df = pd.DataFrame(joint_drifts_array, columns=TableFieldsIncluded)
    # Convert &#39;DriftX&#39; and &#39;DriftY&#39; columns to float
    df[[&#39;DriftX&#39;, &#39;DriftY&#39;]] = df[[&#39;DriftX&#39;, &#39;DriftY&#39;]].astype(float)

    # Group the DataFrame by &#39;Story&#39; and calculate the minimum and maximum values of &#39;DriftX&#39; and &#39;DriftY&#39;
    df = df.groupby(&#39;Story&#39;)[[&#39;DriftX&#39;, &#39;DriftY&#39;]].agg([&#39;max&#39;])

    # Flatten the column names by joining them with an underscore
    df.columns = [&#39;_&#39;.join(col).strip() for col in df.columns.values]

    # Reset the index to make &#39;Story&#39; a regular column
    df.reset_index(inplace=True)

    # Sort the DataFrame by &#39;Story&#39; column in alphabetical order
    df = df.sort_values(&#39;Story&#39;, ascending=True)

    # Create a scatter plot with lines connecting the points
    plt.figure()
    plt.plot(df[&#39;DriftX_max&#39;], df[&#39;Story&#39;], label=&#39;DriftX_max&#39;)
    plt.plot(df[&#39;DriftY_max&#39;], df[&#39;Story&#39;], label=&#39;DriftY_max&#39;)

    # Add labels and title
    plt.xlabel(&#39;Drift&#39;)
    plt.title(&#39;Drift vs. Story&#39;)
    # Add a legend
    plt.legend()

    # Get the maximum value of Drifts
    max_drift_x = df[&#39;DriftX_max&#39;].max()
    max_drift_y = df[&#39;DriftY_max&#39;].max()

    bold_terminal(&#34;Story drift for selected joints check&#34;)
    FU(&#34;Drift X&#34;, max_drift_x, predefined_max_drift)
    FU(&#34;Drift Y&#34;, max_drift_y, predefined_max_drift)
    
    return df

def get_DiaphragmCMDisplacements(SapModel, LoadCaseList=[&#34;Dead&#34;], building_height = 100,max_BuildingDrift=1/400):
    &#34;&#34;&#34;
    Parameters:
        SapModel: Active SapModel to get results from.
        LoadCaseList (list): List of load cases to get results from. 
        building_height (int): Total building height, in ft.
        max_BuildingDrift (float): Maximum alllowable building drift.
    returns:
    df (DataFrame). A data frame with all the Center of Mass displacement of the stories for a list of cases. 
    &#34;&#34;&#34;
    #Get the data using API
    SapModel.DatabaseTables.SetLoadCasesSelectedForDisplay(LoadCaseList)
    TableFields = SapModel.DatabaseTables.GetAllFieldsInTable(&#39;Diaphragm Center Of Mass Displacements&#39;)[3]
    CMDisplacements = SapModel.DatabaseTables.GetTableForDisplayArray(&#39;Diaphragm Center Of Mass Displacements&#39;, TableFields, &#34;All&#34;)[4]
    TableFieldsIncluded = SapModel.DatabaseTables.GetTableForDisplayArray(&#39;Diaphragm Center Of Mass Displacements&#39;, TableFields, &#34;All&#34;)[2]

    # Determine the number of columns
    NumColumns = len(TableFieldsIncluded)

    # Reshape the JointDrifts list into a 2D array with the appropriate dimensions
    CMDisplacements_array = [CMDisplacements[i:i+NumColumns] for i in range(0, len(CMDisplacements), NumColumns)]
    # Create the DataFrame using the reshaped array and the column names
    df = pd.DataFrame(CMDisplacements_array, columns=TableFieldsIncluded)

    # Convert &#39;UY&#39; and &#39;UY column to float
    df[[&#39;UX&#39;,&#39;UY&#39;]] = df[[&#39;UX&#39;,&#39;UY&#39;]].astype(float)

    # Group the DataFrame by &#39;Story&#39; and calculate the minimum and maximum values of &#39;Drift&#39;
    # df = df.groupby([&#39;Story&#39;])[[&#39;UX&#39;, &#39;UY&#39;]].agg([&#39;max&#39;,&#39;min&#39;])
    df = df.groupby(&#39;Story&#39;)[[&#39;UX&#39;, &#39;UY&#39;]].agg(lambda x: abs(x).max())

    # Reset the index to make &#39;Story&#39; a regular column
    df.reset_index(inplace=True)

    # Sort the DataFrame by &#39;Story&#39; column in alphabetical order
    df = df.sort_values(&#39;Story&#39;, ascending=True)

    # Create a scatter plot with lines connecting the points
    plt.figure()
    plt.plot(df[&#39;UX&#39;], df[&#39;Story&#39;], label=&#39;UX_max&#39;)
    # plt.plot(df[&#39;UX_min&#39;], df[&#39;Story&#39;], label=&#39;UX_min&#39;)
    plt.plot(df[&#39;UY&#39;], df[&#39;Story&#39;], label=&#39;UY_max&#39;)
    # plt.plot(df[&#39;UY_min&#39;], df[&#39;Story&#39;], label=&#39;UY_min&#39;)

    # Add labels and title
    plt.xlabel(&#39;CM Displacement&#39;)
    plt.title(&#39;CM Displacement vs. Story&#39;)
    # Add a legend
    plt.legend()    

    # Get the maximum value of Drifts
    max_displacement_x = df[&#39;UX&#39;].max()
    max_displacement_y = df[&#39;UY&#39;].max()

    bold_terminal(&#34;Diaphragm Center of Mass total displacement check&#34;)
    FU(&#34;CM Displacement X&#34;, max_displacement_x, building_height*12*max_BuildingDrift)
    FU(&#34;CM Displacement Y&#34;, max_displacement_y, building_height*12*max_BuildingDrift)

    return df</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="etabsninja.get_functions.get_DiaphragmCMDisplacements"><code class="name flex">
<span>def <span class="ident">get_DiaphragmCMDisplacements</span></span>(<span>SapModel, LoadCaseList=['Dead'], building_height=100, max_BuildingDrift=0.0025)</span>
</code></dt>
<dd>
<div class="desc"><h2 id="parameters">Parameters</h2>
<p>SapModel: Active SapModel to get results from.
LoadCaseList (list): List of load cases to get results from.
building_height (int): Total building height, in ft.
max_BuildingDrift (float): Maximum alllowable building drift.
returns:
df (DataFrame). A data frame with all the Center of Mass displacement of the stories for a list of cases.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_DiaphragmCMDisplacements(SapModel, LoadCaseList=[&#34;Dead&#34;], building_height = 100,max_BuildingDrift=1/400):
    &#34;&#34;&#34;
    Parameters:
        SapModel: Active SapModel to get results from.
        LoadCaseList (list): List of load cases to get results from. 
        building_height (int): Total building height, in ft.
        max_BuildingDrift (float): Maximum alllowable building drift.
    returns:
    df (DataFrame). A data frame with all the Center of Mass displacement of the stories for a list of cases. 
    &#34;&#34;&#34;
    #Get the data using API
    SapModel.DatabaseTables.SetLoadCasesSelectedForDisplay(LoadCaseList)
    TableFields = SapModel.DatabaseTables.GetAllFieldsInTable(&#39;Diaphragm Center Of Mass Displacements&#39;)[3]
    CMDisplacements = SapModel.DatabaseTables.GetTableForDisplayArray(&#39;Diaphragm Center Of Mass Displacements&#39;, TableFields, &#34;All&#34;)[4]
    TableFieldsIncluded = SapModel.DatabaseTables.GetTableForDisplayArray(&#39;Diaphragm Center Of Mass Displacements&#39;, TableFields, &#34;All&#34;)[2]

    # Determine the number of columns
    NumColumns = len(TableFieldsIncluded)

    # Reshape the JointDrifts list into a 2D array with the appropriate dimensions
    CMDisplacements_array = [CMDisplacements[i:i+NumColumns] for i in range(0, len(CMDisplacements), NumColumns)]
    # Create the DataFrame using the reshaped array and the column names
    df = pd.DataFrame(CMDisplacements_array, columns=TableFieldsIncluded)

    # Convert &#39;UY&#39; and &#39;UY column to float
    df[[&#39;UX&#39;,&#39;UY&#39;]] = df[[&#39;UX&#39;,&#39;UY&#39;]].astype(float)

    # Group the DataFrame by &#39;Story&#39; and calculate the minimum and maximum values of &#39;Drift&#39;
    # df = df.groupby([&#39;Story&#39;])[[&#39;UX&#39;, &#39;UY&#39;]].agg([&#39;max&#39;,&#39;min&#39;])
    df = df.groupby(&#39;Story&#39;)[[&#39;UX&#39;, &#39;UY&#39;]].agg(lambda x: abs(x).max())

    # Reset the index to make &#39;Story&#39; a regular column
    df.reset_index(inplace=True)

    # Sort the DataFrame by &#39;Story&#39; column in alphabetical order
    df = df.sort_values(&#39;Story&#39;, ascending=True)

    # Create a scatter plot with lines connecting the points
    plt.figure()
    plt.plot(df[&#39;UX&#39;], df[&#39;Story&#39;], label=&#39;UX_max&#39;)
    # plt.plot(df[&#39;UX_min&#39;], df[&#39;Story&#39;], label=&#39;UX_min&#39;)
    plt.plot(df[&#39;UY&#39;], df[&#39;Story&#39;], label=&#39;UY_max&#39;)
    # plt.plot(df[&#39;UY_min&#39;], df[&#39;Story&#39;], label=&#39;UY_min&#39;)

    # Add labels and title
    plt.xlabel(&#39;CM Displacement&#39;)
    plt.title(&#39;CM Displacement vs. Story&#39;)
    # Add a legend
    plt.legend()    

    # Get the maximum value of Drifts
    max_displacement_x = df[&#39;UX&#39;].max()
    max_displacement_y = df[&#39;UY&#39;].max()

    bold_terminal(&#34;Diaphragm Center of Mass total displacement check&#34;)
    FU(&#34;CM Displacement X&#34;, max_displacement_x, building_height*12*max_BuildingDrift)
    FU(&#34;CM Displacement Y&#34;, max_displacement_y, building_height*12*max_BuildingDrift)

    return df</code></pre>
</details>
</dd>
<dt id="etabsninja.get_functions.get_StoryDriftsForJoints"><code class="name flex">
<span>def <span class="ident">get_StoryDriftsForJoints</span></span>(<span>SapModel, LoadCaseList=['Dead'], GroupName='All', predefined_max_drift=0.0025)</span>
</code></dt>
<dd>
<div class="desc"><p>returns:
df (DataFrame). A data frame with all the drifts of selected column Joints for all the stories.
test</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_StoryDriftsForJoints(SapModel, LoadCaseList=[&#34;Dead&#34;], GroupName=&#34;All&#34;, predefined_max_drift = 0.0025):
    &#34;&#34;&#34;
    returns:
    df (DataFrame). A data frame with all the drifts of selected column Joints for all the stories. 
    test
    &#34;&#34;&#34;
    JointsGroupName = GroupName # Put &#34;All&#34; for all nodes of the model
    TableName = &#34;Joint Drifts&#34;
    SapModel.DatabaseTables.SetLoadCasesSelectedForDisplay(LoadCaseList)
    TableFields = SapModel.DatabaseTables.GetAllFieldsInTable(TableName)[2]
    JointDrifts = SapModel.DatabaseTables.GetTableForDisplayArray(TableName, TableFields, JointsGroupName)[4]
    TableFieldsIncluded = SapModel.DatabaseTables.GetTableForDisplayArray(TableName, TableFields, &#34;All&#34;)[2]

    # Determine the number of columns
    NumColumns = len(TableFieldsIncluded)

    # Reshape the JointDrifts list into a 2D array with the appropriate dimensions
    joint_drifts_array = [JointDrifts[i:i+NumColumns] for i in range(0, len(JointDrifts), NumColumns)]

    # Create the DataFrame using the reshaped array and the column names
    df = pd.DataFrame(joint_drifts_array, columns=TableFieldsIncluded)
    # Convert &#39;DriftX&#39; and &#39;DriftY&#39; columns to float
    df[[&#39;DriftX&#39;, &#39;DriftY&#39;]] = df[[&#39;DriftX&#39;, &#39;DriftY&#39;]].astype(float)

    # Group the DataFrame by &#39;Story&#39; and calculate the minimum and maximum values of &#39;DriftX&#39; and &#39;DriftY&#39;
    df = df.groupby(&#39;Story&#39;)[[&#39;DriftX&#39;, &#39;DriftY&#39;]].agg([&#39;max&#39;])

    # Flatten the column names by joining them with an underscore
    df.columns = [&#39;_&#39;.join(col).strip() for col in df.columns.values]

    # Reset the index to make &#39;Story&#39; a regular column
    df.reset_index(inplace=True)

    # Sort the DataFrame by &#39;Story&#39; column in alphabetical order
    df = df.sort_values(&#39;Story&#39;, ascending=True)

    # Create a scatter plot with lines connecting the points
    plt.figure()
    plt.plot(df[&#39;DriftX_max&#39;], df[&#39;Story&#39;], label=&#39;DriftX_max&#39;)
    plt.plot(df[&#39;DriftY_max&#39;], df[&#39;Story&#39;], label=&#39;DriftY_max&#39;)

    # Add labels and title
    plt.xlabel(&#39;Drift&#39;)
    plt.title(&#39;Drift vs. Story&#39;)
    # Add a legend
    plt.legend()

    # Get the maximum value of Drifts
    max_drift_x = df[&#39;DriftX_max&#39;].max()
    max_drift_y = df[&#39;DriftY_max&#39;].max()

    bold_terminal(&#34;Story drift for selected joints check&#34;)
    FU(&#34;Drift X&#34;, max_drift_x, predefined_max_drift)
    FU(&#34;Drift Y&#34;, max_drift_y, predefined_max_drift)
    
    return df</code></pre>
</details>
</dd>
<dt id="etabsninja.get_functions.get_StoryDriftsForStories"><code class="name flex">
<span>def <span class="ident">get_StoryDriftsForStories</span></span>(<span>SapModel, LoadCaseList=['Dead'], predefined_max_drift=0.0025)</span>
</code></dt>
<dd>
<div class="desc"><p>returns:
df (DataFrame). A data frame with all the drifts of the stories for a single case.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_StoryDriftsForStories(SapModel, LoadCaseList=[&#34;Dead&#34;], predefined_max_drift = 0.0025):
    &#34;&#34;&#34;
    returns:
    df (DataFrame). A data frame with all the drifts of the stories for a single case. 
    &#34;&#34;&#34;
    #Get the data using API
    SapModel.DatabaseTables.SetLoadCasesSelectedForDisplay(LoadCaseList)
    TableName = &#34;Story Drifts&#34;
    TableFields = SapModel.DatabaseTables.GetAllFieldsInTable(TableName)[2]
    JointDrifts = SapModel.DatabaseTables.GetTableForDisplayArray(TableName, TableFields, &#34;All&#34;)[4]
    TableFieldsIncluded = SapModel.DatabaseTables.GetTableForDisplayArray(TableName, TableFields, &#34;All&#34;)[2]
    # Determine the number of columns
    NumColumns = len(TableFieldsIncluded)

    # Reshape the JointDrifts list into a 2D array with the appropriate dimensions
    joint_drifts_array = [JointDrifts[i:i+NumColumns] for i in range(0, len(JointDrifts), NumColumns)]

    # Create the DataFrame using the reshaped array and the column names
    df = pd.DataFrame(joint_drifts_array, columns=TableFieldsIncluded)

    # Convert &#39;Drift&#39; column to float
    df[[&#39;Drift&#39;]] = df[[&#39;Drift&#39;]].astype(float)

    # Group the DataFrame by &#39;Story&#39; and calculate the minimum and maximum values of &#39;Drift&#39;
    df = df.groupby([&#39;Story&#39;,&#39;Direction&#39;])[[&#39;Drift&#39;]].agg([&#39;max&#39;])

    # Flatten the column names by joining them with an underscore
    df.columns = [&#39;_&#39;.join(col).strip() for col in df.columns.values]

    # Reset the index to make &#39;Story&#39; a regular column
    df.reset_index(inplace=True)

    # Pivot the DataFrame to create separate columns for &#39;DriftX&#39; and &#39;DriftY&#39; values
    df = df.pivot(index=&#39;Story&#39;, columns=&#39;Direction&#39;, values=&#39;Drift_max&#39;).reset_index()

    # Rename the columns
    df.columns = [&#39;Story&#39;, &#39;DriftX_max&#39;, &#39;DriftY_max&#39;]

    # Sort the DataFrame by &#39;Story&#39; column in alphabetical order
    df = df.sort_values(&#39;Story&#39;, ascending=True)

    # Create a scatter plot with lines connecting the points
    plt.plot(df[&#39;DriftX_max&#39;], df[&#39;Story&#39;], label=&#39;DriftX_max&#39;)
    plt.plot(df[&#39;DriftY_max&#39;], df[&#39;Story&#39;], label=&#39;DriftY_max&#39;)

    # Add labels and title
    plt.xlabel(&#39;Drift&#39;)
    plt.title(&#39;Drift vs. Story&#39;)
    # Add a legend
    plt.legend()

    # Get the maximum value of Drifts
    max_drift_x = df[&#39;DriftX_max&#39;].max()
    max_drift_y = df[&#39;DriftY_max&#39;].max()

    bold_terminal(&#34;Story drift for stories check&#34;)
    FU(&#34;Drift X&#34;, max_drift_x, predefined_max_drift)
    FU(&#34;Drift Y&#34;, max_drift_y, predefined_max_drift)

    return df</code></pre>
</details>
</dd>
<dt id="etabsninja.get_functions.get_all_frames"><code class="name flex">
<span>def <span class="ident">get_all_frames</span></span>(<span>SapModel)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns:
frames_data (DataFrame): A DataFrame with data of all frames.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_all_frames(SapModel):
    &#34;&#34;&#34;
    Returns:
    frames_data (DataFrame): A DataFrame with data of all frames.
    &#34;&#34;&#34;
    # Get the frame objects using the API
    frame_objs = SapModel.FrameObj.GetAllFrames()
    
    # Create an empty list to hold frame data
    frames = []
    
    # Populate the frames list with data from frame_objs
    for i in range(frame_objs[0]):
        frameNm = frame_objs[1][i]
        prop = frame_objs[2][i]
        story = frame_objs[3][i]
        pt1 = frame_objs[4][i]
        pt2 = frame_objs[5][i]
        x1 = frame_objs[6][i]
        y1 = frame_objs[7][i]
        z1 = frame_objs[8][i]
        x2 = frame_objs[9][i]
        y2 = frame_objs[10][i]
        z2 = frame_objs[11][i]
        rot = frame_objs[12][i]
        offX1 = frame_objs[13][i]
        offY1 = frame_objs[14][i]
        offZ1 = frame_objs[15][i]
        offX2 = frame_objs[16][i]
        offY2 = frame_objs[17][i]
        offZ2 = frame_objs[18][i]
        cardPt = frame_objs[19][i]
        
        frames.append([
            frameNm, prop, story,
            pt1, pt2,
            x1, y1, z1,
            x2, y2, z2,
            rot,
            offX1, offY1, offZ1,
            offX2, offY2, offZ2,
            cardPt
        ])
    
    # Create a DataFrame from the list
    columns = [
        &#39;Frame Name&#39;, &#39;Property&#39;, &#39;Story&#39;,
        &#39;Point 1&#39;, &#39;Point 2&#39;,
        &#39;X1&#39;, &#39;Y1&#39;, &#39;Z1&#39;,
        &#39;X2&#39;, &#39;Y2&#39;, &#39;Z2&#39;,
        &#39;Rotation&#39;,
        &#39;Offset X1&#39;, &#39;Offset Y1&#39;, &#39;Offset Z1&#39;,
        &#39;Offset X2&#39;, &#39;Offset Y2&#39;, &#39;Offset Z2&#39;,
        &#39;Cardinal Point&#39;
    ]
    frames_data = pd.DataFrame(frames, columns=columns)
    
    return frames_data</code></pre>
</details>
</dd>
<dt id="etabsninja.get_functions.get_all_materials"><code class="name flex">
<span>def <span class="ident">get_all_materials</span></span>(<span>SapModel)</span>
</code></dt>
<dd>
<div class="desc"><p>Gets the materials in the current model. Will return in units mm, N &amp; MPa.</p>
<p>If the property type is either 'Concrete' or 'Steel', the function will
be expanded so that the strength of materials are included.</p>
<p>Returns
materials : Type dict</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_all_materials(SapModel):
    &#34;&#34;&#34;
    Gets the materials in the current model. Will return in units mm, N &amp; MPa.
    
    If the property type is either &#39;Concrete&#39; or &#39;Steel&#39;, the function will
    be expanded so that the strength of materials are included.
    
    Returns
    materials : Type dict
    &#34;&#34;&#34;
    # Set the Etabs units, all strength of materials will be returned in MPa
    # SapModel.SetPresentUnits(9);
    # switch to k-in units
    kip_in_F = 3
    ret = SapModel.SetPresentUnits(kip_in_F)

    # Etabs material type enumerators
    mat_types={1:&#39;Steel&#39;,2:&#39;Concrete&#39;,3:&#39;NoDesign&#39;,4:&#39;Aluminum&#39;,5:&#39;ColdFormed&#39;,
               6:&#39;Rebar&#39;,7:&#39;Tendon&#39;,8:&#39;Masonry&#39;}; 
    mat_name_list=SapModel.PropMaterial.GetNameList();
    materials={};
    for i in range(mat_name_list[0]):
        mat_name=mat_name_list[1][i];
        mat_props=SapModel.PropMaterial.GetMaterial(mat_name);
        mat_type=mat_types[mat_props[0]];
        if(mat_type==&#39;Concrete&#39;):
            mat_conc_prop=SapModel.PropMaterial.GetOConcrete_1(mat_name);
            conc_fc=mat_conc_prop[0];
            materials[mat_name]={&#39;mat_name&#39;:mat_name,&#39;mat_type&#39;:mat_type,
                                 &#39;fc&#39;:conc_fc};
        elif(mat_type==&#39;Steel&#39;):
            mat_steel_prop=SapModel.PropMaterial.GetOSteel_1(mat_name);
            steel_fy=mat_steel_prop[0];
            steel_fu=mat_steel_prop[1];
            materials[mat_name]={&#39;mat_name&#39;:mat_name,&#39;mat_type&#39;:mat_type,
                                 &#39;fy&#39;:steel_fy,&#39;fu&#39;:steel_fu};
        else:
            materials[mat_name]={&#39;mat_name&#39;:mat_name,&#39;mat_type&#39;:mat_type};
    return materials;</code></pre>
</details>
</dd>
<dt id="etabsninja.get_functions.get_all_points"><code class="name flex">
<span>def <span class="ident">get_all_points</span></span>(<span>SapModel, inc_restraint=True)</span>
</code></dt>
<dd>
<div class="desc"><p>This will return all the points of the model.</p>
<p>Parameters:
SapModel : SapModel.Pointer
inc_restraint : boolean (set True for restraints to be included
to points list)
units : str. Default to 'mm'</p>
<p>Returns:
points : list (Points in current Etabs model). Elements in the points
list if inc_restraint==False [pt_nm,x,y,z]. If inc_restraint==True the
point element = [pt_nm,x,y,z,(FUx,FUy,FUz,FRx,FRy,FRz)]</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_all_points(SapModel,inc_restraint=True):
    &#34;&#34;&#34;
    This will return all the points of the model.
    
    Parameters:
    SapModel : SapModel.Pointer
    inc_restraint : boolean (set True for restraints to be included
                             to points list)
    units : str. Default to &#39;mm&#39;
    
    Returns:
    points : list (Points in current Etabs model). Elements in the points
    list if inc_restraint==False [pt_nm,x,y,z]. If inc_restraint==True the
    point element = [pt_nm,x,y,z,(FUx,FUy,FUz,FRx,FRy,FRz)]
    &#34;&#34;&#34;
    [numberPts,ptNames,ptX,ptY,ptZ,ptCsys]=SapModel.PointObj.GetAllPoints();
    #initiate a temporary list to contain the restrained points data
    ptsRestraint=[];
    if(inc_restraint==True):
        for i in range(numberPts):
            ptRestraintSA=SapModel.PointObj.GetRestraint(ptNames[i]);
            ptRestraint=ptRestraintSA[0];
            ptsRestraint.append(ptRestraint);
    #Initiate the points list
    points=[]
    for i in range(numberPts):
        if(inc_restraint==True):
            points.append([ptNames[i],ptX[i],ptY[i],ptZ[i],ptsRestraint[i]]);
        else:
            points.append([ptNames[i],ptX[i],ptY[i],ptZ[i]]);
    # Define column names
    if inc_restraint:
        columns = [&#39;Point Name&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;, &#39;Restraint&#39;]
    else:
        columns = [&#39;Point Name&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;]
    
    # Create a DataFrame from the list
    points_data = pd.DataFrame(points, columns=columns)
    
    return points_data</code></pre>
</details>
</dd>
<dt id="etabsninja.get_functions.get_story_data"><code class="name flex">
<span>def <span class="ident">get_story_data</span></span>(<span>SapModel)</span>
</code></dt>
<dd>
<div class="desc"><p>returns:
story_data (list). The is a nested list with each element consists of
[story_nm,story_ele,story_hgt,is_master_story,similar_to,splice_above,
splice_height]</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_story_data(SapModel):
    &#34;&#34;&#34;
    returns:
    story_data (list). The is a nested list with each element consists of
    [story_nm,story_ele,story_hgt,is_master_story,similar_to,splice_above,
     splice_height]
    &#34;&#34;&#34;
    #Get the data using API
    story_in=SapModel.Story.GetStories()
    #Separate the data to lists
    nos_stories=story_in[0];
    story_nms=story_in[1];
    story_eles=story_in[2];
    story_hgts=story_in[3];
    is_master_story=story_in[4];
    similar_to_story=story_in[5];
    splice_above=story_in[6];
    splice_height=story_in[7];
    # Create a dictionary to hold the data
    story_data_dict = {
        &#39;Name&#39;: story_nms[::-1],
        &#39;Elevation (in)&#39;: [round(ele, 3) for ele in story_eles[::-1]],
        &#39;Story height (in)&#39;: [round(hgt, 3) for hgt in story_hgts[::-1]],
        &#39;Master Story&#39;: is_master_story[::-1],
        &#39;Similar to&#39;: similar_to_story[::-1],
        &#39;Splice above&#39;: splice_above[::-1],
        &#39;Splice height&#39;: splice_height[::-1]
    }
    
    # Create a DataFrame from the dictionary
    story_data = pd.DataFrame(story_data_dict)
    return story_data</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="etabsninja" href="index.html">etabsninja</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="etabsninja.get_functions.get_DiaphragmCMDisplacements" href="#etabsninja.get_functions.get_DiaphragmCMDisplacements">get_DiaphragmCMDisplacements</a></code></li>
<li><code><a title="etabsninja.get_functions.get_StoryDriftsForJoints" href="#etabsninja.get_functions.get_StoryDriftsForJoints">get_StoryDriftsForJoints</a></code></li>
<li><code><a title="etabsninja.get_functions.get_StoryDriftsForStories" href="#etabsninja.get_functions.get_StoryDriftsForStories">get_StoryDriftsForStories</a></code></li>
<li><code><a title="etabsninja.get_functions.get_all_frames" href="#etabsninja.get_functions.get_all_frames">get_all_frames</a></code></li>
<li><code><a title="etabsninja.get_functions.get_all_materials" href="#etabsninja.get_functions.get_all_materials">get_all_materials</a></code></li>
<li><code><a title="etabsninja.get_functions.get_all_points" href="#etabsninja.get_functions.get_all_points">get_all_points</a></code></li>
<li><code><a title="etabsninja.get_functions.get_story_data" href="#etabsninja.get_functions.get_story_data">get_story_data</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>